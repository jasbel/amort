<div class="container">
    <div class="header">
      <h1>üè¶ Calculadora de Amortizaci√≥n Acelerada</h1>
      <p>Simula pagos extras para reducir el tiempo de tu pr√©stamo</p>
    </div>

    <div class="instructions">
      <h4>üìù Instrucciones:</h4>
      <p>‚Ä¢ <strong>Cuota m√≠nima:</strong> <span id="cuota-minima-msg">{{ formatCurrency(currentCuotaMinima) }}</span> cada mes<br>
        ‚Ä¢ <strong>Pagos extras:</strong> Modifica los montos en la columna "Tu Pago" para simular pagos
        mayores<br>
        ‚Ä¢ <strong>Botones r√°pidos:</strong> Usa los botones para aplicar el mismo monto a todas las cuotas<br>
        ‚Ä¢ <strong>Recalcular:</strong> Presiona "Recalcular" despu√©s de hacer cambios</p>
    </div>

    <div class="loan-info">
      <div class="info-card">
        <h3>Capital Prestado (Bs)</h3>
        <input type="number" v-model.number="capital" class="value value-input">
      </div>
      <div class="info-card">
        <h3>Tasa Anual (%)</h3>
        <input type="number" v-model.number="tasaAnual" class="value value-input">
      </div>
      <div class="info-card">
        <h3>Plazo Original (meses)</h3>
        <input type="number" v-model.number="plazo" class="value value-input">
      </div>
      <div class="info-card">
        <h3>Cuota M√≠nima</h3>
        <div class="value value-input">{{ formatCurrency(currentCuotaMinima) }}</div>
      </div>
    </div>

    <div class="quick-amounts">
      <button class="quick-btn" @click="fillAllPayments(2107)">Cuota M√≠nima (<span>{{ formatCurrency(currentCuotaMinima) }}</span>)</button>
      <button class="quick-btn" @click="fillAllPayments(3000)">3,000 Bs</button>
      <button class="quick-btn" @click="fillAllPayments(5000)">5,000 Bs</button>
      <button class="quick-btn" @click="fillAllPayments(8000)">8,000 Bs</button>
      <button class="quick-btn" @click="fillAllPayments(10000)">10,000 Bs</button>
    </div>

    <div class="controls">
      <button class="btn btn-success" @click="recalculate()">üîÑ Recalcular Tabla</button>
      <button class="btn" @click="exportToCSV()">üìä Exportar CSV</button>
      <button class="btn" @click="printTable()">üñ®Ô∏è Imprimir</button>
      <button class="btn btn-warning" @click="resetTablePayment()">‚Ü©Ô∏è Restablecer Tu Pago</button>
    </div>

    <div class="alert" v-if="alertMessage">{{ alertMessage }}</div>

    <div class="table-container">
      <div class="table-scroll">
        <table id="amortization-table">
          <thead>
            <tr>
              <th>Cuota</th>
              <th>Fecha</th>
              <th>Tu Pago</th>
              <th>Cuota M√≠n.</th>
              <th>Intereses</th>
              <th>A Capital</th>
              <th>Pago Extra</th>
              <th>Seguro de desgravamen</th>
              <th>Saldo</th>
            </tr>
          </thead>
          <tbody>
            <tr v-for="(row, index) in amortizationTable" :key="index" :class="{ 'pago-extra': row.pagoExtra > 1, 'prestamo-terminado': row.saldoPendiente <= 0.01 }">
              <td class="numero-cuota">{{ row.cuota }}</td>
              <td style="text-align: center;">{{ row.fecha }}</td>
              <td style="text-align: center;">
                <input type="number" class="pago-input" v-model.number="row.pagoUsuario" @change="recalculate()" :min="Math.round(currentCuotaMinima)" step="100">
              </td>
              <td class="amount min-amount">{{ formatCurrency(row.cuotaMinima) }}</td>
              <td class="amount">{{ formatCurrency(row.intereses) }}</td>
              <td class="amount">{{ formatCurrency(row.capitalPago) }}</td>
              <td class="amount amount-extra">{{ formatCurrency(row.pagoExtra) }}</td>
              <td class="amount">{{ formatCurrency(row.seguroDesgravamen) }}</td>
              <td class="amount">{{ formatCurrency(Math.max(0, row.saldoPendiente)) }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="summary">
      <div class="summary-card">
        <h3>Total a Pagar</h3>
        <div class="value value-input">{{ formatCurrency(summary.totalPagado) }}</div>
      </div>
      <div class="summary-card">
        <h3>Total Intereses</h3>
        <div class="value value-input">{{ formatCurrency(summary.totalIntereses) }}</div>
      </div>
      <div class="summary-card success">
        <h3>Tiempo Estimado</h3>
        <div class="value value-input">{{ summary.tiempoFinal }} meses</div>
      </div>
      <div class="summary-card success">
        <h3>Ahorro en Intereses</h3>
        <div class="value value-input">{{ formatCurrency(summary.ahorroIntereses) }}</div>
      </div>
      <div class="summary-card success">
        <h3>Tiempo Ahorrado</h3>
        <div class="value value-input">{{ summary.tiempoAhorrado }} meses</div>
      </div>
      <div class="summary-card success">
        <h3>Monto Total Extra</h3>
        <div class="value value-input">{{ formatCurrency(summary.totalExtra) }}</div>
      </div>
      <div class="summary-card">
        <h3>Total Seguro</h3>
        <div class="value value-input">{{ formatCurrency(summary.totalSeguro) }}</div>
      </div>
    </div>
  </div>